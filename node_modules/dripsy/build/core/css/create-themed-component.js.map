{"version":3,"file":"create-themed-component.js","sourceRoot":"","sources":["../../../src/core/css/create-themed-component.tsx"],"names":[],"mappings":"AAAA,OAAO,KAA2D,MAAM,OAAO,CAAA;AAC/E,OAAO,EAAE,cAAc,EAAE,MAAM,qBAAqB,CAAA;AACpD,OAAO,EAAE,kBAAkB,EAAE,MAAM,sBAAsB,CAAA;AACzD,OAAO,EAAE,yBAAyB,EAAE,MAAM,aAAa,CAAA;AAEvD,OAAO,EAAE,aAAa,EAAE,MAAM,0BAA0B,CAAA;AAuBxD,MAAM,UAAU,qBAAqB,CAKnC,SAAY,EACZ,EACE,YAAY,EAAE,SAAS,EACvB,GAAG,OAAO,KAC6B,EAAE;IAS3C,MAAM,gBAAgB,GAAG,KAAK,CAAC,UAAU,CAGvC,SAAS,OAAO,CAAC,IAAI,EAAE,GAAG;QAC1B,MAAM,EACJ,EAAE,EAAE,GAAG,EACP,EAAE,EACF,OAAO,EACP,KAAK,EACL,QAAQ,EACR,QAAQ,GAAG,OAAO,CAAC,eAAe,EAClC,GAAG,KAAK,EACT,GAAG,IAAI,CAAA;QACR,IAAI,OAAO,OAAO,KAAK,WAAW,IAAI,OAAO,EAAE,KAAK,QAAQ,EAAE;YAC5D,OAAO,CAAC,KAAK,CACX,uDAAuD,EAAE,4FAA4F,CACtJ,CAAA;SACF;QACD,MAAM,YAAY,GAChB,OAAO,SAAS,IAAI,UAAU,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,CAAA;QAE9D,MAAM,EAAE,KAAK,EAAE,GAAG,cAAc,EAAE,CAAA;QAClC,kFAAkF;QAClF,MAAM,EAAE,GAAG,OAAO,GAAG,IAAI,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,CAAA;QAEtD,MAAM,UAAU,GAAG,kBAAkB,EAAE,CAAA;QAEvC,MAAM,EAAE,MAAM,EAAE,GAAG,aAAa,CAC9B,GAAG,EAAE,CACH,yBAAyB,CACvB;YACE,KAAK;YACL,UAAU;YACV,OAAO;YACP,EAAE;YACF,KAAK;YACL,QAAQ,EAAE,QAAe;SAC1B,EACD;YACE,GAAG,OAAO;YACV,QAAQ,EAAE,QAAQ,IAAI,OAAO,CAAC,QAAQ;YACtC,YAAY;SACb,CACF,EACH,CAAC,KAAK,EAAE,UAAU,EAAE,OAAO,EAAE,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,YAAY,CAAC,CAC1E,CAAA;QAED,MAAM,YAAY,GAAG,EAAE,IAAI,SAAS,CAAA;QAEpC,OAAO,CACL,CAAC,YAAY,CACX,IAAK,KAAa,CAAC,CACnB,GAAG,CAAC,CAAC,GAAG,CAAC,CACT,KAAK,CAAC,CAAC,MAAM,CAAC,CACd,IAAI;YACF,OAAO,EAAE,OAAO,IAAI,OAAO,CAAC,cAAc;SAC3C,CAAC,EACF,CACH,CAAA;IACH,CAAC,CAAC,CAAA;IAEF,gBAAgB,CAAC,WAAW,GAAG,UAC7B,SAAS,EAAE,WAAW,IAAI,iBAC5B,EAAE,CAAA;IAEF,OAAO,gBAAuB,CAAA;AAChC,CAAC","sourcesContent":["import React, { ComponentProps, ComponentType, PropsWithChildren } from 'react'\nimport { useDripsyTheme } from '../use-dripsy-theme'\nimport { useBreakpointIndex } from './breakpoint-context'\nimport { mapPropsToStyledComponent } from './map-props'\nimport { DripsyFinalTheme } from '../types-v2/declarations'\nimport { useStableMemo } from '../utils/use-stable-memo'\nimport { StyledProps, ThemedOptions } from '../types-v2/sx'\n\ntype MergeProps<P1, P2> = Omit<P1, keyof P2> & P2\ntype PropsWithoutVariants<P> = Omit<P, 'variant' | 'variants'>\ntype PropsWithStyledProps<\n  P,\n  ThemeKey extends keyof DripsyFinalTheme | undefined\n> = P & StyledProps<ThemeKey>\n\nexport type Props<\n  C,\n  ExtraProps,\n  ThemeKey extends keyof DripsyFinalTheme | undefined\n> = C extends ComponentType<infer BaseProps>\n  ? MergeProps<\n      PropsWithoutVariants<BaseProps>,\n      PropsWithStyledProps<ExtraProps, ThemeKey>\n    >\n  : never\n\ntype GetProps<C> = C extends ComponentType<infer P> ? P : never\n\nexport function createThemedComponent<\n  C extends ComponentType<any>,\n  ExtraProps,\n  ThemeKey extends keyof DripsyFinalTheme | undefined\n>(\n  Component: C,\n  {\n    defaultStyle: baseStyle,\n    ...options\n  }: ThemedOptions<ExtraProps, ThemeKey> = {}\n): React.ForwardRefExoticComponent<\n  React.PropsWithoutRef<\n    Omit<PropsWithChildren<GetProps<C>>, 'variant' | 'variants'>\n  > &\n    StyledProps<ThemeKey> &\n    React.RefAttributes<React.ElementRef<C>> &\n    ExtraProps\n> {\n  const WrappedComponent = React.forwardRef<\n    any,\n    Props<C, ExtraProps, ThemeKey> & { style?: any }\n  >(function Wrapped(prop, ref) {\n    const {\n      sx: _sx,\n      as,\n      variant,\n      style,\n      themeKey,\n      variants = options.defaultVariants,\n      ...props\n    } = prop\n    if (typeof __DEV__ !== 'undefined' && typeof as === 'string') {\n      console.error(\n        `[dripsy] Looks like you used an invalid \"as\" prop. \"${as}\" can't be a string. Please pass a valid React component. HTML elements are not supported.`\n      )\n    }\n    const defaultStyle =\n      typeof baseStyle == 'function' ? baseStyle(prop) : baseStyle\n\n    const { theme } = useDripsyTheme()\n    // make the sx factory out here so that it's a stable dependency for useStableMemo\n    const sx = typeof _sx == 'function' ? _sx(theme) : _sx\n\n    const breakpoint = useBreakpointIndex()\n\n    const { styles } = useStableMemo(\n      () =>\n        mapPropsToStyledComponent<ThemeKey>(\n          {\n            theme,\n            breakpoint,\n            variant,\n            sx,\n            style,\n            variants: variants as any,\n          },\n          {\n            ...options,\n            themeKey: themeKey ?? options.themeKey,\n            defaultStyle,\n          }\n        ),\n      [theme, breakpoint, variant, sx, style, variants, themeKey, defaultStyle]\n    )\n\n    const TheComponent = as || Component\n\n    return (\n      <TheComponent\n        {...(props as any)}\n        ref={ref}\n        style={styles}\n        {...{\n          variant: variant || options.defaultVariant,\n        }}\n      />\n    )\n  })\n\n  WrappedComponent.displayName = `Dripsy.${\n    Component?.displayName ?? 'NoNameComponent'\n  }`\n\n  return WrappedComponent as any\n}\n"]}